<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Operating Characteristics for Posterior Probability method — ocPostprob • phase1b</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Operating Characteristics for Posterior Probability method — ocPostprob"><meta name="description" content='
Calculate operating characteristics for posterior probability method.
It is assumed that the true response rate is truep.
The trial is stopped for Efficacy if the posterior probability to be
above p1 is larger than tU, and stopped for Futility if the posterior
probability to be below p0 is larger than tL:
Stop criteria for Efficacy :
Pr(truep &amp;gt; p1) &amp;gt; tU
Stop criteria for Futility :
Pr(truep &amp;lt; p0) &amp;gt; tL
Resulting operating characteristics include the following:
ExpectedN: expected number of patients in the trials
PrStopEarly: probability to stop the trial early (before reaching the
maximum sample size)
PrEarlyEff: probability of Early Go decision
PrEarlyFut: probability of for Early Stop decision
PrEfficacy: probability of Go decision
PrFutility: probability of Stop decision
PrGrayZone: probability between Go and Stop ,"Evaluate" or Gray decision zone

'><meta property="og:description" content='
Calculate operating characteristics for posterior probability method.
It is assumed that the true response rate is truep.
The trial is stopped for Efficacy if the posterior probability to be
above p1 is larger than tU, and stopped for Futility if the posterior
probability to be below p0 is larger than tL:
Stop criteria for Efficacy :
Pr(truep &amp;gt; p1) &amp;gt; tU
Stop criteria for Futility :
Pr(truep &amp;lt; p0) &amp;gt; tL
Resulting operating characteristics include the following:
ExpectedN: expected number of patients in the trials
PrStopEarly: probability to stop the trial early (before reaching the
maximum sample size)
PrEarlyEff: probability of Early Go decision
PrEarlyFut: probability of for Early Stop decision
PrEfficacy: probability of Go decision
PrFutility: probability of Stop decision
PrGrayZone: probability between Go and Stop ,"Evaluate" or Gray decision zone

'><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-125641273-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-125641273-1');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">phase1b</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/introduction.html">`phase1b`: Tools for Decision Making in Phase 1b Studies</a></li>
    <li><a class="dropdown-item" href="../articles/test.html">test</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/genentech/phase1b"><span class="fa fa-github"></span></a></li>
<!-- start dropdown for versions --> <li class="nav-item dropdown">
        <a href="#" class="nav-link dropdown-toggle"
          data-bs-toggle="dropdown" role="button"
          aria-expanded="false" aria-haspopup="true"
          id="dropdown-versions">Versions</a> <div class="dropdown-menu" aria-labelledby="dropdown-versions"> <a class="dropdown-item" data-toggle="tooltip" title="" href="https://Genentech.github.io/phase1b/main">main</a> </div></li>
<!-- end dropdown for versions -->
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Operating Characteristics for Posterior Probability method</h1>
      <small class="dont-index">Source: <a href="https://github.com/genentech/phase1b/blob/main/R/ocPostprob.R" class="external-link"><code>R/ocPostprob.R</code></a></small>
      <div class="d-none name"><code>ocPostprob.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="figures/lifecycle-experimental.svg" alt="[Experimental]"></a></p>
<p>Calculate operating characteristics for posterior probability method.</p>
<p>It is assumed that the true response rate is <code>truep</code>.
The trial is stopped for Efficacy if the posterior probability to be
above <code>p1</code> is larger than <code>tU</code>, and stopped for Futility if the posterior
probability to be below <code>p0</code> is larger than <code>tL</code>:</p>
<p>Stop criteria for Efficacy :</p>
<p><code>Pr(truep &gt; p1) &gt; tU</code></p>
<p>Stop criteria for Futility :</p>
<p><code>Pr(truep &lt; p0) &gt; tL</code></p>
<p>Resulting operating characteristics include the following:</p><ul><li><p><code>ExpectedN</code>: expected number of patients in the trials</p></li>
<li><p><code>PrStopEarly</code>: probability to stop the trial early (before reaching the
maximum sample size)</p></li>
<li><p><code>PrEarlyEff</code>: probability of Early Go decision</p></li>
<li><p><code>PrEarlyFut</code>: probability of for Early Stop decision</p></li>
<li><p><code>PrEfficacy</code>: probability of Go decision</p></li>
<li><p><code>PrFutility</code>: probability of Stop decision</p></li>
<li><p><code>PrGrayZone</code>: probability between Go and Stop ,"Evaluate" or Gray decision zone</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ocPostprob</span><span class="op">(</span></span>
<span>  <span class="va">nnE</span>,</span>
<span>  <span class="va">truep</span>,</span>
<span>  <span class="va">p0</span>,</span>
<span>  <span class="va">p1</span>,</span>
<span>  <span class="va">tL</span>,</span>
<span>  <span class="va">tU</span>,</span>
<span>  parE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  sim <span class="op">=</span> <span class="fl">50000</span>,</span>
<span>  wiggle <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  nnF <span class="op">=</span> <span class="va">nnE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-nne">nnE<a class="anchor" aria-label="anchor" href="#arg-nne"></a></dt>
<dd><p>(<code>numeric</code>):<br> sample size or sizes where study can be stopped for Efficacy decision. If different for Futility decision,
specify in <code>nnF</code>.</p></dd>


<dt id="arg-truep">truep<a class="anchor" aria-label="anchor" href="#arg-truep"></a></dt>
<dd><p>(<code>number</code>):<br> assumed true response rate.</p></dd>


<dt id="arg-p-">p0<a class="anchor" aria-label="anchor" href="#arg-p-"></a></dt>
<dd><p>(<code>number</code>):<br> lower Futility threshold of response rate.</p></dd>


<dt id="arg-p-">p1<a class="anchor" aria-label="anchor" href="#arg-p-"></a></dt>
<dd><p>(<code>number</code>):<br> upper Efficacy threshold of response rate.</p></dd>


<dt id="arg-tl">tL<a class="anchor" aria-label="anchor" href="#arg-tl"></a></dt>
<dd><p>(<code>number</code>):<br> posterior probability threshold for being below <code>p0</code>.</p></dd>


<dt id="arg-tu">tU<a class="anchor" aria-label="anchor" href="#arg-tu"></a></dt>
<dd><p>(<code>number</code>):<br> posterior probability threshold for being above <code>p1</code>.</p></dd>


<dt id="arg-pare">parE<a class="anchor" aria-label="anchor" href="#arg-pare"></a></dt>
<dd><p>(<code>numeric</code>):<br> alpha and beta parameters for the prior on the treatment population.
Default set at alpha = 1, beta = 1, or uniform prior.</p></dd>


<dt id="arg-sim">sim<a class="anchor" aria-label="anchor" href="#arg-sim"></a></dt>
<dd><p>(<code>number</code>):<br> number of simulations.</p></dd>


<dt id="arg-wiggle">wiggle<a class="anchor" aria-label="anchor" href="#arg-wiggle"></a></dt>
<dd><p>(<code>flag</code>):<br> generate random look locations (not default).
if <code>TRUE</code>, optional to specify <code>dist</code> (see @details).</p></dd>


<dt id="arg-nnf">nnF<a class="anchor" aria-label="anchor" href="#arg-nnf"></a></dt>
<dd><p>(<code>numeric</code>):<br> sample size or sizes where study can be stopped for Futility decision if different from Efficacy decision.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with the following elements:</p><ul><li><p><code>oc</code>: matrix with operating characteristics (see @details section)</p></li>
<li><p><code>nn</code>: vector of look locations that was supplied</p></li>
<li><p><code>nnE</code>: vector of Efficacy look locations</p></li>
<li><p><code>nnF</code>: vector of Futility look locations</p></li>
<li><p><code>params</code>: user input arguments.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># For three looks of 10, 20 and 30 we have the following assumptions :</span></span></span>
<span class="r-in"><span><span class="co"># True response rate or truep of the treatment group = 40%</span></span></span>
<span class="r-in"><span><span class="co"># The following are the Stop rules respectively :</span></span></span>
<span class="r-in"><span><span class="co"># Look for Efficacy: Pr(truep &gt; 30% )&gt; 80%</span></span></span>
<span class="r-in"><span><span class="co"># Look for Futility: Pr(truep &lt; 20% )&gt; 60%</span></span></span>
<span class="r-in"><span><span class="co"># Prior of treatment arm parE= Beta(1,1).</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">ocPostprob</span><span class="op">(</span></span></span>
<span class="r-in"><span>  nnE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">20</span>, <span class="fl">30</span><span class="op">)</span>, truep <span class="op">=</span> <span class="fl">0.40</span>, p0 <span class="op">=</span> <span class="fl">0.20</span>, p1 <span class="op">=</span> <span class="fl">0.30</span>, tL <span class="op">=</span> <span class="fl">0.60</span>, tU <span class="op">=</span> <span class="fl">0.80</span>, parE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  sim <span class="op">=</span> <span class="fl">50</span>, wiggle <span class="op">=</span> <span class="cn">TRUE</span>, nnF <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">20</span>, <span class="fl">30</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Advise to use sim &gt;= 50000 to achieve convergence</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">res</span><span class="op">$</span><span class="va">oc</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ExpectedN PrStopEarly PrEarlyEff PrEarlyFut PrEfficacy PrFutility PrGrayZone</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     18.28         0.7        0.6        0.1       0.82        0.1       0.08</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># We specify the distance in this example.</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">ocPostprob</span><span class="op">(</span></span></span>
<span class="r-in"><span>  nnE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">20</span>, <span class="fl">30</span><span class="op">)</span>, truep <span class="op">=</span> <span class="fl">0.40</span>, p0 <span class="op">=</span> <span class="fl">0.20</span>, p1 <span class="op">=</span> <span class="fl">0.30</span>, tL <span class="op">=</span> <span class="fl">0.60</span>, tU <span class="op">=</span> <span class="fl">0.80</span>, parE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  sim <span class="op">=</span> <span class="fl">50</span>, wiggle <span class="op">=</span> <span class="cn">TRUE</span>, nnF <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">20</span>, <span class="fl">30</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Advise to use sim &gt;= 50000 to achieve convergence</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">res</span><span class="op">$</span><span class="va">oc</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ExpectedN PrStopEarly PrEarlyEff PrEarlyFut PrEfficacy PrFutility PrGrayZone</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1        18         0.7       0.64       0.06       0.78       0.06       0.16</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Here, nnE = nnF, and no wiggle room is allowed. Random distance also not supplied.</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">ocPostprob</span><span class="op">(</span></span></span>
<span class="r-in"><span>  nnE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">20</span>, <span class="fl">30</span><span class="op">)</span>, truep <span class="op">=</span> <span class="fl">0.40</span>, p0 <span class="op">=</span> <span class="fl">0.20</span>, p1 <span class="op">=</span> <span class="fl">0.30</span>, tL <span class="op">=</span> <span class="fl">0.60</span>, tU <span class="op">=</span> <span class="fl">0.80</span>, parE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  sim <span class="op">=</span> <span class="fl">50</span>, wiggle <span class="op">=</span> <span class="cn">FALSE</span>, nnF <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">20</span>, <span class="fl">30</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Advise to use sim &gt;= 50000 to achieve convergence</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">res</span><span class="op">$</span><span class="va">oc</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ExpectedN PrStopEarly PrEarlyEff PrEarlyFut PrEfficacy PrFutility PrGrayZone</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      19.2        0.66       0.66          0       0.84          0       0.16</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Here, we only have one Futility and Efficacy look or stop.</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">ocPostprob</span><span class="op">(</span></span></span>
<span class="r-in"><span>  nnE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>, truep <span class="op">=</span> <span class="fl">0.40</span>, p0 <span class="op">=</span> <span class="fl">0.20</span>, p1 <span class="op">=</span> <span class="fl">0.30</span>, tL <span class="op">=</span> <span class="fl">0.60</span>, tU <span class="op">=</span> <span class="fl">0.80</span>, parE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  sim <span class="op">=</span> <span class="fl">50</span>, wiggle <span class="op">=</span> <span class="cn">FALSE</span>, nnF <span class="op">=</span> <span class="fl">10</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Advise to use sim &gt;= 50000 to achieve convergence</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">res</span><span class="op">$</span><span class="va">oc</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ExpectedN PrStopEarly PrEarlyEff PrEarlyFut PrEfficacy PrFutility PrGrayZone</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1        10           0          0          0       0.28       0.04       0.68</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Here, we only have one Futility but many Efficacy looks or stop.</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">ocPostprob</span><span class="op">(</span></span></span>
<span class="r-in"><span>  nnE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">20</span>, <span class="fl">30</span><span class="op">)</span>, truep <span class="op">=</span> <span class="fl">0.40</span>, p0 <span class="op">=</span> <span class="fl">0.20</span>, p1 <span class="op">=</span> <span class="fl">0.30</span>, tL <span class="op">=</span> <span class="fl">0.60</span>, tU <span class="op">=</span> <span class="fl">0.80</span>, parE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  sim <span class="op">=</span> <span class="fl">50</span>, wiggle <span class="op">=</span> <span class="cn">FALSE</span>, nnF <span class="op">=</span> <span class="fl">10</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Advise to use sim &gt;= 50000 to achieve convergence</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">res</span><span class="op">$</span><span class="va">oc</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ExpectedN PrStopEarly PrEarlyEff PrEarlyFut PrEfficacy PrFutility PrGrayZone</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      20.4        0.64       0.56       0.08       0.64       0.08       0.28</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Daniel Sabanes Bove, Markus Elze, Tony Pourmohamad, Jiawen Zhu, James Lymp, Anastasia Teterina, Audrey Yeo, F. Hoffmann-La Roche Ltd.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

